**字体子集（Font Subsetting）** 是一种优化网页字体加载性能的技术，指的是：

> **只从完整字体文件中提取当前页面实际用到的字符（如中文、英文、数字、标点等），生成一个更小的新字体文件，而不是加载整个庞大的字体。**

---

### 🧩 为什么需要字体子集？

#### 问题：完整字体文件太大

- 中文字体（如思源黑体、苹方、HarmonyOS Sans）通常包含 **2 万~7 万个汉字**。
- 一个完整的 `.woff2` 中文字体文件可能 **5MB~10MB+**！
- 而你的网页可能只用了 **几十个或几百个字**（比如标题、按钮文案）。

#### 后果：

- 用户要下载几 MB 的字体 → **首屏慢**
- 浪费带宽和流量（尤其移动端）
- 可能引发 **CLS（布局偏移）** 或 **FOIT/FOUT（字体闪现）**

---

### ✅ 字体子集如何解决这个问题？

假设你的网页只显示这句话：

> “欢迎来到我们的网站！Hello World 123”

那么字体子集工具会：

1. 扫描文本内容，提取出所有用到的字符：
    
    ```
    欢 迎 来 到 我 们 的 网 站 ！ H e l o W r d 1 2 3 （空格、标点）
    ```
    
2. 从原始字体中**只保留这些字符的字形数据**
3. 生成一个**仅几百 KB 甚至几十 KB 的新字体文件**

→ 用户只需下载这个“精简版”字体，**速度大幅提升**！

---

### 🔧 常见应用场景

| 场景                   | 说明                                  |
| -------------------- | ----------------------------------- |
| **英文/拉丁字母网站**        | 即使英文字体小，子集化也能进一步减少体积（如只保留 A-Z, 0-9） |
| **中日韩（CJK）网站**       | 效果最显著！从 5MB → 50KB                  |
| **图标字体（Icon Fonts）** | 如 Font Awesome，通常只用其中几个图标，可大幅裁剪     |
| **多语言网站**            | 按语言动态生成不同子集                         |

---

### 🛠️ 如何生成字体子集？

#### 工具推荐：

|工具|特点|
|---|---|
|**[Glyphhanger](https://github.com/filamentgroup/glyphhanger)**|自动扫描 HTML/CSS/JS，提取文本并生成子集（支持 WOFF2）|
|**[fonttools](https://github.com/fonttools/fonttools)**（Python）|强大底层库，支持精细控制|
|**[subset-font](https://www.npmjs.com/package/subset-font)**（Node.js）|简单易用，适合集成到构建流程|
|**在线工具**|如 [Transfonter](https://transfonter.org/)（手动输入文本生成子集）|

#### 示例（使用 Glyphhanger）：

```bash
# 扫描网站并生成仅包含所需字符的 WOFF2 字体
glyphhanger https://example.com --format=woff2 --output=./subset/

# 输出：subset/CustomFont-subset.woff2 （可能只有原文件的 1% 大小）
```

---

### ⚠️ 注意事项

1. **动态内容无法覆盖**  
    如果用户评论、搜索结果等包含**未预知的字符**，子集字体可能显示为方框（□）。  
    → 解决方案：对核心静态内容做子集，动态内容回退到系统字体。
    
2. **需配合 `unicode-range` 使用（可选但推荐）**  
    在 CSS 中指定该字体只用于特定 Unicode 范围：
    
    ```css
    @font-face {
      font-family: 'SubsetFont';
      src: url('subset.woff2') format('woff2');
      unicode-range: U+4E00-9FFF, U+0030-0039, U+0041-005A; /* 中文 + 数字 + 大写英文字母 */
    }
    ```
    
3. **不要对系统字体做子集**  
    系统字体（如 `-apple-system`, `Segoe UI`）由操作系统提供，无需加载，也**不能子集化**。
    

---

### 🌐 实际效果对比

| 字体                         | 完整版大小  | 子集版大小（仅用 50 字） | 减少比例       |
| -------------------------- | ------ | -------------- | ---------- |
| 思源黑体（Source Han Sans）      | 8.2 MB | ~80 KB         | **99%↓**   |
| Noto Sans SC（Google Fonts） | 4.7 MB | ~60 KB         | **98.7%↓** |
| Inter（英文字体）                | 200 KB | ~30 KB         | **85%↓**   |

> 💡 对于中文网站，**字体子集是提升性能的“必选项”**。

---

### ✅ 总结

| 关键点         | 说明                           |
| ----------- | ---------------------------- |
| **字体子集是什么** | 只包含页面实际用到字符的精简字体             |
| **目的**      | 减小字体文件体积，加快加载，降低 CLS 风险      |
| **最适合**     | 中文、日文、韩文等大字符集字体              |
| **实现方式**    | 使用工具（如 Glyphhanger）扫描文本并裁剪字体 |
| **注意事项**    | 动态内容需谨慎处理，避免缺字               |

通过字体子集，你可以让自定义字体既保持品牌一致性，又不牺牲性能——**兼顾美观与速度的最佳实践之一**。